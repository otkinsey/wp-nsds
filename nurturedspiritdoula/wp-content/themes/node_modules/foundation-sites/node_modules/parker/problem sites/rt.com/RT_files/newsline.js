var newsLineScrollTimeout = null;
var autoScrollTimeline = true;
function showNextNewsLine() {
    clearTimeout(newsLineScrollTimeout);
    var e = $('.creeping-line p:first-child');
    $('.creeping-line .messages').append(e.clone());
    e.animate({marginTop:'-' + e.height() + 'px'}, 1000, 'swing', function () {
        e.remove();
        if (autoScrollTimeline) {
            newsLineScrollTimeout = setTimeout(showNextNewsLine, 3000);
        }
    });
    return false;
}

function showPrevNewsLine() {
    var e = $('.creeping-line p:last-child');
    var ec = e.clone();
    ec.css({marginTop:'-' + e.height() + 'px'});
    $('.creeping-line .messages').prepend(ec);
    e.remove();
    ec.animate({marginTop:'0px'}, 1000, 'swing');
    return false;
}

function startNewsLineAutoscroll() {
    $('.creeping-line .play').removeClass('play').addClass('pause');
    autoScrollTimeline = true;
    newsLineScrollTimeout = setTimeout(showNextNewsLine, 8000);
    return false;
}

function stopNewsLineAutoscroll() {
    $('.creeping-line .pause').removeClass('pause').addClass('play');
    autoScrollTimeline = false;
    clearTimeout(newsLineScrollTimeout);
    return false;
}

$(function () {
    $('.creeping-line .prev').live('click', function () {
        stopNewsLineAutoscroll();
        if (!($('.creeping-line p:first-child').is(':animated'))) {
            showPrevNewsLine();
        }
        return false;
    });
    $('.creeping-line .pause').live('click', function () {
        stopNewsLineAutoscroll();
        return false;
    });
    $('.creeping-line .play').live('click', function () {
        startNewsLineAutoscroll()
        return false;
    });
    $('.creeping-line .next').live('click', function () {
        stopNewsLineAutoscroll();
        if (!($('.creeping-line p:first-child').is(':animated'))) {
            showNextNewsLine();
        }
        return false;
    });
    startNewsLineAutoscroll();
});